This is the 2D code in matlab
