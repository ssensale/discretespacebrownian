This is the 1D code in matlab
